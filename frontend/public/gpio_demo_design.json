{
  "design_metadata": {
    "name": "gpio_demo_top",
    "version": "1.0",
    "description": "GPIO Demo Design",
    "top_module": "gpio_demo_top"
  },

  "module_library": {
    "gpio_demo_top": {
      "module_type": "top_level",
      "ports": [
        {"name": "sys_clk", "direction": "input", "width": 1, "type": "clock"},
        {"name": "sys_rst_n", "direction": "input", "width": 1, "type": "reset"},
        {"name": "ahb_haddr", "direction": "input", "width": 32, "type": "address"},
        {"name": "ahb_hwdata", "direction": "input", "width": 32, "type": "data"},
        {"name": "gpio_pins", "direction": "inout", "width": 16, "type": "gpio"},
        {"name": "ahb_hrdata", "direction": "output", "width": 32, "type": "data"},
        {"name": "led_display", "direction": "output", "width": 8, "type": "display"},
        {"name": "system_irq", "direction": "output", "width": 1, "type": "interrupt"}
      ],
      "internal_structure": {
        "instances": [
          {
            "name": "u_clk_gen",
            "module_type": "clk_generator"
          },
          {
            "name": "u_ahb_apb_bridge", 
            "module_type": "ahb_to_apb_bridge"
          },
          {
            "name": "u_gpio_ctrl",
            "module_type": "cmsdk_iop_gpio"
          },
          {
            "name": "u_irq_ctrl",
            "module_type": "interrupt_controller"
          },
          {
            "name": "u_led_driver",
            "module_type": "led_driver"
          }
        ],
        "port_connections": [
          {
            "net": "clk_main",
            "connections": [
              {"type": "instance_port", "instance": "u_clk_gen", "port": "clk_out"},
              {"type": "instance_port", "instance": "u_ahb_apb_bridge", "port": "hclk"},
              {"type": "instance_port", "instance": "u_gpio_ctrl", "port": "HCLK"},
              {"type": "instance_port", "instance": "u_irq_ctrl", "port": "clk"},
              {"type": "instance_port", "instance": "u_led_driver", "port": "clk"}
            ]
          },
          {
            "net": "apb_addr_bus",
            "connections": [
              {"type": "instance_port", "instance": "u_ahb_apb_bridge", "port": "paddr"},
              {"type": "instance_port", "instance": "u_gpio_ctrl", "port": "PADDR"}
            ]
          },
          {
            "net": "apb_data_bus",
            "connections": [
              {"type": "instance_port", "instance": "u_ahb_apb_bridge", "port": "pwdata"},
              {"type": "instance_port", "instance": "u_gpio_ctrl", "port": "PWDATA"}
            ]
          },
          {
            "net": "gpio_interrupt",
            "connections": [
              {"type": "instance_port", "instance": "u_gpio_ctrl", "port": "GPIOINT"},
              {"type": "instance_port", "instance": "u_irq_ctrl", "port": "irq_in"}
            ]
          },
          {
            "net": "gpio_data",
            "connections": [
              {"type": "instance_port", "instance": "u_gpio_ctrl", "port": "PORTOUT"},
              {"type": "instance_port", "instance": "u_led_driver", "port": "gpio_data"}
            ]
          }
        ]
      }
    },

    "clk_generator": {
      "module_type": "utility",
      "ports": [
        {"name": "clk_in", "direction": "input", "width": 1, "type": "clock"},
        {"name": "rst_n", "direction": "input", "width": 1, "type": "reset"},
        {"name": "clk_out", "direction": "output", "width": 1, "type": "clock"}
      ]
    },

    "ahb_to_apb_bridge": {
      "module_type": "bridge",
      "ports": [
        {"name": "hclk", "direction": "input", "width": 1, "type": "clock"},
        {"name": "haddr", "direction": "input", "width": 32, "type": "address"},
        {"name": "hwdata", "direction": "input", "width": 32, "type": "data"},
        {"name": "hrdata", "direction": "output", "width": 32, "type": "data"},
        {"name": "paddr", "direction": "output", "width": 32, "type": "address"},
        {"name": "pwdata", "direction": "output", "width": 32, "type": "data"}
      ]
    },

    "cmsdk_iop_gpio": {
      "module_type": "gpio",
      "ports": [
        {"name": "HCLK", "direction": "input", "width": 1, "type": "clock"},
        {"name": "PADDR", "direction": "input", "width": 32, "type": "address"},
        {"name": "PWDATA", "direction": "input", "width": 32, "type": "data"},
        {"name": "PORTIN", "direction": "input", "width": 16, "type": "gpio"},
        {"name": "PRDATA", "direction": "output", "width": 32, "type": "data"},
        {"name": "PORTOUT", "direction": "output", "width": 16, "type": "gpio"},
        {"name": "GPIOINT", "direction": "output", "width": 16, "type": "interrupt"}
      ]
    },

    "interrupt_controller": {
      "module_type": "controller",
      "ports": [
        {"name": "clk", "direction": "input", "width": 1, "type": "clock"},
        {"name": "rst_n", "direction": "input", "width": 1, "type": "reset"},
        {"name": "irq_in", "direction": "input", "width": 16, "type": "interrupt"},
        {"name": "irq_out", "direction": "output", "width": 1, "type": "interrupt"}
      ]
    },

    "led_driver": {
      "module_type": "driver",
      "ports": [
        {"name": "clk", "direction": "input", "width": 1, "type": "clock"},
        {"name": "rst_n", "direction": "input", "width": 1, "type": "reset"},
        {"name": "gpio_data", "direction": "input", "width": 8, "type": "data"},
        {"name": "led_out", "direction": "output", "width": 8, "type": "display"}
      ]
    }
  }
}